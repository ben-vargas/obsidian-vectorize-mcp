name = "obvec"
main = "src/index.ts"
compatibility_date = "2025-07-30"
compatibility_flags = ["nodejs_compat"]

# Standard MCP Durable Object
[[durable_objects.bindings]]
name = "MCP_OBJECT"
class_name = "ObsidianVectorizeMCP"
script_name = "obvec"

# ChatGPT-specific Durable Object
[[durable_objects.bindings]]
name = "CHATGPT_MCP_OBJECT"
class_name = "ChatGPTMCP"
script_name = "obvec"

[[migrations]]
tag = "v2"
new_sqlite_classes = ["ObsidianVectorizeMCP", "ChatGPTMCP"]

[vars]
EMBEDDING_MODEL = "@cf/baai/bge-large-en-v1.5"
EMBEDDING_DIMENSIONS = "1024"
# Optional: Set your Obsidian vault name for proper URL generation in ChatGPT
# OBSIDIAN_VAULT_NAME = "YourVaultName"

# Authentication Configuration
# Set your MCP password using: wrangler secret put MCP_PASSWORD

[ai]
binding = "AI"

[[vectorize]]
binding = "VECTORIZE"
index_name = "obsidian-notes"

# KV namespace for general storage
# Create with: wrangler kv:namespace create kv
[[kv_namespaces]]
binding = "KV"
id = "YOUR_KV_NAMESPACE_ID"
preview_id = "YOUR_KV_NAMESPACE_PREVIEW_ID"

# KV namespace for OAuth tokens
# Create with: wrangler kv:namespace create oauth_tokens
[[kv_namespaces]]
binding = "OAUTH_KV"
id = "YOUR_OAUTH_KV_NAMESPACE_ID"
preview_id = "YOUR_OAUTH_KV_NAMESPACE_PREVIEW_ID"

# R2 bucket for note content and metadata
# Create with: wrangler r2 bucket create obsidian-vectorize
[[r2_buckets]]
binding = "R2"
bucket_name = "obsidian-vectorize"
preview_bucket_name = "obsidian-vectorize-preview"